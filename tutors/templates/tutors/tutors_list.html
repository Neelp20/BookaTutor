{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4 text-center fw-bold">Available Tutors</h2>

    <!-- 📚 Subject Filter -->
    <form method="get" class="row g-3 mb-4 justify-content-center">
        <div class="col-md-4">
            <select name="subject" class="form-select">
                <option value="">All Subjects</option>
                {% for subject in subjects %}
                    <option value="{{ subject.name }}" {% if subject.name == selected_subject %}selected{% endif %}>
                        {{ subject.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2 d-grid">
            <button type="submit" class="btn btn-primary">Filter</button>
        </div>
        <div class="col-md-2 d-grid">
            <a href="{% url 'tutors-list' %}" class="btn btn-secondary">Reset</a>
        </div>
    </form>

    <!-- 🧑‍🏫 Tutors Grid -->
    <div class="row g-4">
        {% for tutor in tutors %}
        <div class="col-md-4">
            <div class="card h-100 shadow-sm border-0 rounded-3">
                <div class="text-center mt-3">
                    {% if tutor.profile_image %}
                        <img src="{{ tutor.profile_image.url }}" alt="{{ tutor.user.username }}"
                             class="img-fluid rounded-circle shadow-sm"
                             style="width:120px; height:120px; object-fit:cover;">
                    {% else %}
                        <img src="{% static 'images/default-profile.png' %}" alt="Default profile"
                             class="img-fluid rounded-circle shadow-sm"
                             style="width:120px; height:120px; object-fit:cover;">
                    {% endif %}
                </div>

                <div class="card-body text-center">
                    <h4 class="card-title mt-3">{{ tutor.user.get_full_name|default:tutor.user.username }}</h4>

                    <!-- Subjects -->
                    <p class="text-muted mb-1">
                        <strong>Subjects:</strong>
                        {% if tutor.subjects.all %}
                            {{ tutor.subjects.all|join:", " }}
                        {% else %}
                            Not specified
                        {% endif %}
                    </p>

                    <!-- Bio -->
                    <p class="small mb-2">
                        {% if tutor.bio %}
                            {{ tutor.bio|truncatechars:100 }}
                        {% else %}
                            <span class="text-muted">No bio available.</span>
                        {% endif %}
                    </p>

                    <!-- Experience -->
                    <p class="mb-1">
                        <strong>Experience:</strong>
                        {% if tutor.years_of_experience %}
                            {{ tutor.years_of_experience }} years
                        {% else %}
                            <span class="text-muted">N/A</span>
                        {% endif %}
                    </p>

                    <!-- Hourly Rate -->
                    <p class="mb-3"><strong>Rate:</strong> ${{ tutor.hourly_rate }}/hr</p>

                    <a href="{% url 'tutor-detail' tutor.pk %}" class="btn btn-primary w-75">View Profile</a>
                </div>
            </div>
        </div>
        {% empty %}
        <p class="text-center text-muted">No tutors found for this subject.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}

